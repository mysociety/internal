#
# httpd.conf:
# Apache configuration fragment for lists.mysociety.org.
#
# Copyright (c) 2006 UK Citizens Online Democracy. All rights reserved.
# Email: chris@mysociety.org; WWW: http://www.mysociety.org/
#
# $Id: httpd.conf,v 1.6 2006-06-28 11:46:04 chris Exp $
#

<Location /admin/lists>
    Options +ExecCGI
    AddHandler fastcgi-script .cgi

    RewriteEngine on

    # Don't need ".cgi" to refer to CGI scripts.
    RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI}.cgi -f
    RewriteRule /(.+) /$1.cgi [PT]
</Location>

<Location /admin/lists/mailman>
    Options +ExecCGI
    SetHandler cgi-script

    RewriteEngine on

    # If the user doesn't have the site admin cookie, then redirect via the
    # script which will create it for them.
    RewriteCond %{HTTP_COOKIE}  !site=[0-9A-F]+
    RewriteRule (.*)            ../mailmanlogin?url=$1 [PT,L]
</Location>

